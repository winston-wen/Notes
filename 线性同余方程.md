解线性同余方程 $$ax\equiv b\pmod m$$, 当 $$m$$ 不为质数时, 不方便求 $$a^{-1}$$. 此时的解法是

1. 利用扩展欧几里得算法, 求解 $$\lambda, \mu$$ 使得 $$\lambda a + \mu m = \gcd(a,m)$$.
2. 检查是否 $$\gcd(a,m)\mid b$$. 若满足, 则方程的解为如下公式. 若不满足, 则方程无解.

$$
x=\frac{\lambda b}{\gcd(a,m)} \pmod m.
$$

为什么要检查整除关系? 因为

* $$ax\equiv b \pmod m$$ 等价于: 存在整数 $$x_1$$ 使得 $$ax+mx_1=b$$.
* 后者是个丢番图方程, 有整数解 $$x,x_1$$ 的充要条件是: $$\gcd(a,m)|b$$.

代回去验算一下.
$$
\begin{align}
ax\bmod m &= \frac{\lambda ab}{\gcd(a,m)} \bmod m \\
&=b\cdot\frac{\gcd(a,m)-\mu m}{\gcd(a,m)} \bmod m \\
&=b-\frac{b\mu m}{\gcd(a,m)} \bmod m \\
&=b-x_2m\bmod m ~\textrm{(方程有解的条件)}\\
&= b\bmod m.
\end{align}
$$
