## å›é¡¾

### åŠè´¨æ•°æ£€æµ‹

ç»™å®šéšæœºæ•´æ•° $$p,q$$ æ»¡è¶³ $$p\equiv q\equiv 3\pmod 4$$. ä»¤ $$n=pq$$. å¦‚ä¸‹æ­¥éª¤èƒ½å¤Ÿéšæœºä½†æ— ååœ°åˆ¤æ–­ $$p,q$$ æ˜¯å¦ä¸ºä¸åŒçš„è´¨æ•°.

Step 1. éšæœºæŒ‘é€‰ $$g\in\Z_n^*$$, æ»¡è¶³ $$(g|n)=1$$. æ£€æŸ¥ä»¥ä¸‹æ¡ä»¶, è‹¥ä¸ºçœŸåˆ™ç»§ç»­.
$$
g^\frac{n-p-q+1}{4}\equiv \pm 1\pmod n. \label{s1}\tag{s1}
$$
Step 2. éšæœºæŒ‘é€‰ä¸€é˜¶å¤šé¡¹å¼ $$ax+b\in K$$. ç¾¤ $$K$$ å®šä¹‰ä¸º:
$$
K=\left(\Z_n\left[x\right]/\left(x^2+1\right)\right)^*/\Z_n^*.
$$
ä¹Ÿå°±æ˜¯è¯´, $$a,b\in\Z_n$$, $$\gcd{(a^2+b^2,n)}=1$$. è®¡ç®—ä¸‹å¼,
$$
(Ax+B)=(ax+b)^{(p+1)(q+1)}.
$$
æ£€æŸ¥ä»¥ä¸‹æ¡ä»¶, è‹¥ä¸ºçœŸ, åˆ™ $$p,q$$ çš†ä¸ºè´¨æ•°.
$$
A\equiv0~(\mathrm{mod}~n)\;\land\; \gcd{(b,n)}=1.
$$
### MPC RSAç­¾åçš„è¦ç‚¹

(1) ç”Ÿæˆ $$\lambda$$ åˆ†ç‰‡.

(2) åœ¨ $$\lambda$$ ä»¥åˆ†ç‰‡å½¢å¼å­˜åœ¨çš„æ¡ä»¶ä¸‹, ç”Ÿæˆ $$d$$ åˆ†ç‰‡, ä½¿å¾— $$de\equiv 1\pmod \lambda$$.

----

## MPC RSAå®ç°æ€è·¯

### 1. åˆ†å¸ƒå¼ç”Ÿæˆ $$pq$$

åŸºäºä¸Šä¸€èŠ‚æ‰€å›é¡¾çš„åˆ¤å®šæ–¹æ³•, æˆ‘ä»¬ä¸éš¾å¾—åˆ° $$m$$ æ–¹åŠè´¨æ•°æµ‹å®šç®—æ³•.

Round 1: å„æ–¹åˆ†åˆ«ç”Ÿæˆ $$p_i, q_i$$. å…¶ä¸­, $$p_1,q_1\equiv 3\pmod 4$$, å…¶ä½™ $$p_i,q_i\equiv 0\pmod 4$$. è¿™äº›å‚ä¸æ–¹ä»¥åˆ†å¸ƒå¼ MtA åè®®, è®¡ç®—
$$
n=\left(\sum_{i=1}^m p_i\right)\left(\sum_{j=1}^m q_j\right).
$$
Round 2: è¿™äº›å‚ä¸æ–¹åå•†å‡ºä¸€ä¸ª $$g\in \Z_n^*$$, ä¹Ÿå°±æ˜¯ $$\gcd{(g,n)}=1$$.

Round 3: ç¬¬1æ–¹è®¡ç®— $$v_1=g^{(n-p_1-q_1+1)/4}$$. å…¶ä»–æ–¹è®¡ç®— $$v_i=g^{(p_i+q_i)/4}$$. å„æ–¹åˆ†äº« $$v_i$$.

Round 4: å„æ–¹è®¡ç®— $$v=\prod{v_i}$$. è‡³æ­¤, å…¬å¼ $$\eqref{s1}$$ å¾—ä»¥é‡æ„ä¸ºå®‰å…¨çš„å½¢å¼. æ‰§è¡Œä¸Šä¸€èŠ‚çš„åˆ¤å®šæ–¹æ³•, å®Œæˆåˆ†å¸ƒå¼åŠè´¨æ•°æµ‹å®š.

ğŸ’¡ Round 3 ä¸­çš„åˆ†äº«æ˜¯å®‰å…¨çš„, å› ä¸ºç ´è§£çš„éš¾åº¦æ˜¯æ•´æ•°çš„ç¦»æ•£å¯¹æ•°. å¯¹æ¯”ä¸€ä¸‹, ç›´æ¥å…¬å¼€æŒ‡æ•°æ˜¯ä¸å®‰å…¨çš„. å¦‚æœæ£€æµ‹é€šè¿‡, å„æ–¹å°±å¾—åˆ°å¦‚ä¸‹æ–¹ç¨‹ç»„, è¿›è€Œå¾—åˆ° $$n$$ çš„åˆ†è§£.
$$
\begin{align}
pq&=n, \\
(p-1)(q-1)&=\varphi(n).
\end{align}
$$

### 2. åˆ†å¸ƒå¼ç”Ÿæˆ $$\lambda$$.

è¿™é‡Œä»¤ $$\lambda=\varphi(n)=(p-1)(q-1)$$. ä»ç„¶ä½¿ç”¨ MtA åè®®, åœ¨ç”Ÿæˆ $$pq$$ çš„åŒæ—¶ç”Ÿæˆ $$(p-1)(q-1)$$. å„æ–¹æ‰§è¡Œåˆ°ç®—å‡º $$\lambda_i$$ ä¹‹åå°±ä¸ç»§ç»­é€šä¿¡.

### 3. åˆ†å¸ƒå¼è¯•é™¤æ³•

ä»¥ $$p_i$$ ä¸ºä¾‹. è®¾å¾…æ£€æµ‹çš„å°è´¨æ•°ä¸º $$\pi_k$$.

æ¨èæ–¹æ³•: å„æ–¹éšæœºç”Ÿæˆç§˜å¯† $$r_i$$, ç”¨ MtA è®¡ç®—å’Œæ£€æŸ¥ä¸‹å¼.
$$
pr=\left(\sum_i p_i\right)\left(\sum_j r_j\right) \equiv 0 \pmod{\pi_k}
$$
æ”¹è¿›: $$r$$ ä¹Ÿæœ‰å¯èƒ½è¢« $$\pi_k$$ æ•´é™¤. ä¸ºäº†å°½å¯èƒ½å‡å°‘è¿”å·¥, å¯ä»¥ç”Ÿæˆå¤šä¸ª $$r^{(1)}$$, $$r^{(2)}$$, ... å¦‚æœæ‰€æœ‰ $$pr^{(\cdot)}$$ éƒ½èƒ½è¢« $$\pi_k$$ æ•´é™¤, é‚£ä¹ˆ $$p$$ æå¤§æ¦‚ç‡ä¸æ˜¯è´¨æ•°.

æœ´ç´ ä½†é”™è¯¯çš„æ–¹æ³•: å„æ–¹è®¡ç®— $$p_i\bmod{\pi_k}$$, æ±‚å’Œ. è¦æ³¨æ„ $$p_i\bmod{\pi_k}$$ æ˜¯ä»»äººæ”¶é›†çš„, è¿›è€Œ $$p \bmod \Pi$$, $$\Pi=\prod_k \pi_k$$ å°±æ˜¯å…¬å¼€çš„. é¡»çŸ¥, å‰1000ä¸ªè´¨æ•°çš„ä¹˜ç§¯å·²ç»è¿œè¿œå¤§äº RSA å¯†é’¥èŒƒå›´, å› æ­¤ç”¨ CRM å°±èƒ½å”¯ä¸€æ±‚è§£ RSA å¯†é’¥.

### 4. åˆ†å¸ƒå¼ç”Ÿæˆç§é’¥ $$d$$.

Step 1 : åå•†ä¸€ä¸ªéšæœºçš„å¥‡æ•°å…¬é’¥ $$e$$.

Step 2 : å„æ–¹ç”Ÿæˆä¸´æ—¶éšæœºæ•° $$r_i$$. åˆ©ç”¨ MtA åè®®, è®¡ç®—
$$
R = \left(\sum_{i=1}^m r_i\right)\left(\sum_{j=1}^m \lambda_j\right)
\bmod e.
$$
å¦‚æœ $$\gcd{(R, e)}\ne 1$$ å°±é‡æ–°æ‰§è¡Œ MtA åè®®.

Step 3 : å„æ–¹è®¡ç®— $$t_i=r_iR^{-1}\bmod e$$. æ³¨æ„åˆ°
$$
\sum_{i=1}^m t_i \equiv \left(\sum_{i=1}^m r_i\right)\cdot R^{-1} \equiv \lambda^{-1}\pmod e.
$$
Step 4 : å„æ–¹ä½¿ç”¨ MtA åè®®, å¾—åˆ°
$$
\sum_{i=1}^m u_i = -\left(\sum_{i=1}^m t_i\right)\left(\sum_{j=1}^m \lambda_j\right) + 1 \bmod P.
$$
è¿™é‡Œ, $$P$$ æ˜¯ MtA æ˜æ–‡å–å€¼ä¸Šç•Œ, æ»¡è¶³ $$P>2n^2e$$. è¿™ç§æ„é€ ä½¿å¾— $$\sum u_i\equiv 1\pmod \lambda$$. æ³¨æ„åˆ° $$\sum u_i\equiv 0 \pmod e$$, æˆ‘ä»¬æœ‰ $$e\mid\sum u_i$$. è‡³æ­¤, å„æ–¹å¾—åˆ° $$d$$ åˆ†ç‰‡, ä¹Ÿå°±æ˜¯.
$$
d_i=\left(
\left\lfloor \frac{u_i}{e}\right\rfloor  ,~
u_i\bmod e
\right).
$$

----

## åè®°

(1) å…¬å¼ $$\eqref{s1}$$ ä¸­çš„ $$\frac{\cdot}{4}$$ å¯ä»¥ç®€åŒ–ä¸º
$$
g^\frac{n-p-q+1}{2}\equiv 1\pmod n.
$$
(2) è‹¥å¹²å¸¸æ•°çš„å‡ºå¤„

ffdhe4096

```
https://www.rfc-editor.org/rfc/rfc7919.html#appendix-A.3
```

Group 16

```
https://datatracker.ietf.org/doc/html/rfc3526#section-5
```

