Paper: Linearly Homomorphic Encryption from DDH

Guilhem Castagnos, Fabien Laguillaumie



Every (primitive) ideal $$\mathfrak{a}$$ of $$\mathcal{O}_\Delta$$ can be written as $$\mathfrak{a}=a\Z+\frac{-b+\sqrt{\Delta}}{2}\Z$$, with $$a$$ be a positive integer, and $$b$$ be an integer such that the integer solution $$c$$ of the equation $$\Delta=b^2-4ac$$ exists. The ideal is denoted by $$(a,b)$$ for short.

The next proposition, inspired by [CL09, Theorem 2], establishes the existence of a subgroup of a class group of an imaginary quadratic fields, where the DL problem is EASY.

**Proposition 1**. Let $$k$$ be a fundamental discriminant with $$k\equiv 1 \pmod 4$$ of the form $$k=-pq$$. Let $$p$$ be an odd prime and $$q$$ be a non-negative integer coprime with $$p$$ such that $$q>4p$$. Let $$\mathfrak{t}=(p^2,p)$$ be an ideal of $$\mathcal{O}_{kp^2}$$. Denote by $$f=[\mathfrak{t}]$$ the class of $$\mathfrak{t}$$ in the class group $$C(\mathcal{O}_{kp^2})$$. For $$m\in\left\{1,\dots,p-1\right\}$$, let $$\mathtt{Reduce}(f^m)=(p^2,m^{-1}p)$$, where $$m^{-1}$$ is the odd integer in $$[-p, p]$$ such that $$m^{-1}m\equiv 1\pmod p$$. Finally, $$f$$ is a generator of the subgroup of order $$p$$ of $$C(\mathcal{O}_{kp^2})$$.

**Proof**. We consider the surjection $$\bar\varphi_p:C(\mathcal{O}_{kp^2})\rightarrow C(\mathcal{O}_{k})$$. From [CL09, Lemma 1] and [Cos99, Proposition 7.22 and Theorem 7.24], the kernel of $$\bar\varphi_p$$ is isomorphic to $$\left(\mathcal{O}_{k}/p\mathcal{O}_k\right)^\times/\left(\Z/p\Z\right)^\times$$. 

As $$p\mid k$$, the group $$\left(\mathcal{O}_{k}/p\mathcal{O}_k\right)^\times$$ is isomorphic to $$\left(\mathbb{F}_p[X]/(X^2)\right)^\times$$. This group contains $$p(p-1)$$ elements of the form $$a+b\sqrt{k}$$ where $$a\in\left(\Z/p\Z\right)^\times$$ and $$b\in\left(\Z/p\Z\right)$$.

Now let us consider the quotient group $$\left(\mathcal{O}_{k}/p\mathcal{O}_k\right)^\times/\left(\Z/p\Z\right)^\times$$, where $$[x]=[y]$$ with $$x,y\in\left(\mathcal{O}_{k}/p\mathcal{O}_k\right)^\times$$ if and only if there exists $$\lambda\in\left(\Z/p\Z\right)^\times$$ such that $$x=\lambda y$$. The quotient is cyclic of order $$p$$, and a system of representatives is $$[1]$$ and $$[a+\sqrt{k}]$$ where $$a\in\left(\Z/p\Z\right)^\times$$.

Let $$g=[1+\sqrt{k}]$$, one has $$g^m=[1+m\sqrt{k}]=[m^{-1}+\sqrt{k}]$$ for all $$m\in\left\{1,\dots,p-1\right\}$$; one also has $$g^p=[1]$$.

Let $$\alpha_m=\frac{m^{-1}+\sqrt{k}}{2}\in\mathcal{O}_k$$. Then $$\alpha_m$$ is a representative of the class $$g^m$$. The element $$g^m$$ maps to the class $$[\varphi_p^{-1}(\alpha_m\mathcal{O}_k)]$$ of the kernel of $$\bar\varphi_p$$. From [BTW95, Proposition 2.9], one can see that $$\alpha_m\mathcal{O}_k=\left(N(\alpha_m), -m^{-1} \bmod{2N(\alpha_m)} \right)$$ where the remainder is computed from the centered Euclidean division. Now,
$$
\varphi_p^{-1}(\alpha_m\mathcal{O}_k)=\left(
N(\alpha_m), -pm^{-1} \bmod {2N(\alpha_m)}
\right).
$$
As $$N(\alpha_m)=\frac{(m^{-1})^2-k}{4}$$ and $$q>4p$$, it follows that $$p^2<N(\alpha_m)$$, and that $$-pm^{-1} \bmod {2N(\alpha_m)}=-pm^{-1}$$. As a consequence, this ideal $$\varphi_p^{-1}(\alpha_m\mathcal{O}_k)$$ corresponds to the quadratic form
$$
\left(
\frac{(m^{-1})^2-k}{4},  -pm^{-1},  p^2
\right),
$$
of discriminant $$kp^2$$. Moreover this form is equivalent to the form
$$
\left(
p^2,  pm^{-1}, \frac{(m^{-1})^2-k}{4}
\right),
$$
which corresponds to the ideal $$(p^2, m^{-1}p)$$.

Eventually, this ideal of $$\mathcal{O}_{kp^2}$$ is reduced, since $$\lvert m^{-1}p\rvert < p^2 < \sqrt{\lvert kp^2 \rvert}/2$$.

Consequently, if $$\mathfrak{t}=(p^2,p)$$, then $$[\mathfrak{t}]$$ generates the kernel of $$\bar\varphi_p$$, since $$[\mathfrak{t}]=[\varphi_p^{-1}(\alpha_m\mathcal{O}_k)]$$. Moreover $$[\mathfrak{t}]^m=[\varphi^{-1}(\alpha_m\mathcal{O}_k)]$$, so
$$
\mathtt{Reduce}\left( [\mathfrak{t}]^m \right) = 
\left(p^2, m^{-1}p\right)
$$
for every $$m\in\left\{1,\dots,p-1\right\}$$.     â– 

**Questions**.

Q1. How to compute $$\bar\varphi_p$$?

A1. By GPT 4.1,
$$
\bar\varphi_p\left([\mathfrak{a}]\right)=\mathfrak{a}\mathcal{O}_k,
$$
where $$\mathfrak{a}$$ is an ideal of $$\mathcal{O}_{kp^2}$$.

Q2. What is $$\left(\mathcal{O}_{k}/p\mathcal{O}_k\right)^\times$$? What is $$\left(\mathbb{F}_p[X]/(X^2)\right)^\times$$? Why they are isomorphic?

A2. By GPT 4.1,

$$p\mathcal{O}_k$$ is the ideal of $$\mathcal{O}_k$$ generated by $$p$$.

$$\mathcal{O}_{k}/p\mathcal{O}_k$$ is a finite ring: elements of $$\mathcal{O}_{k}$$ modulo all multiples of $$p$$ in $$\mathcal{O}_k$$. To be more specific, any element can be represented as $$a+b\omega$$, where $$a,b\in\Z_p$$ and $$\omega$$ is $$\sqrt{k}$$ or $$(1+\sqrt{k})/2$$.

$$\mathcal{O}_{k}/p\mathcal{O}_k$$ is the group of units (elements with multiplicative inverse) in the ring.

$$\mathbb{F}_p[X]/(X^2)$$ is the ring of polynomials $$a+bX$$ with $$a,b\in\mathbb{F}_p$$. The units are elements with a multiplicative inverse. In this ring, $$a+bX$$ is invertible, if and only if $$a\neq 0$$.

Take $$\mathcal{O}_k=\Z[\sqrt{k}]$$ (for simplicity, we assume $$k\equiv 2,3 \pmod 4$$).

Q3. What is the representation of an element in $$\left(\mathcal{O}_{k}/p\mathcal{O}_k\right)^\times/\left(\Z/p\Z\right)^\times$$?

A3. Consider $$x=\lambda y$$ as $$x\equiv \lambda y \pmod p$$.