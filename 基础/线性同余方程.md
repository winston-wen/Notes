解线性同余方程 $$Ax\equiv B\pmod M$$, 当 $$m$$ 不为质数时, 不方便求 $$a^{-1}$$. 此时的解法是

(1) 利用扩展欧几里得算法, 求解 $$\lambda, \mu$$ 使得 $$\lambda A + \mu M = \gcd(A, M)$$.

(2) 检查是否 $$\gcd(A,M)\mid B$$. 若满足, 则方程的一个特解为如下公式. 若不满足, 则方程无解.
$$
x_0=\frac{\lambda B}{\gcd(A,M)}.
$$

(3) 方程的通解为
$$
x = x_0+nT.
$$
其中 $$T$$ 为解的周期, 使得 $$AT\equiv 0\pmod M$$. 最小周期满足 $$AT=\mathrm{lcm}(A, M)$$, 故有
$$
T=\frac{M}{\gcd(A,M)}.
$$
为什么要检查整除关系? 因为

* $$Ax\equiv B \pmod M$$ 等价于: 存在整数 $$x_1$$ 使得 $$Ax+Mx_1=B$$.
* 后者是个丢番图方程, 有整数解 $$x,x_1$$ 的充要条件是: $$\gcd(A,M)|B$$.

代回去验算一下.
$$
\begin{align}
Ax &= \frac{\lambda AB}{\gcd(A,M)}  \\
&=B\cdot\frac{\gcd(A,M)-\mu M}{\gcd(A,M)}  \\
&=B-\frac{B\mu }{\gcd(A,M)}  \\
&=B-x_2M ~\textrm{(方程有解的条件)}\\
&\equiv B\pmod M.
\end{align}
$$
